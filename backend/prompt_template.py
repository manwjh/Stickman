"""
Prompt 模板生成器

为 LLM 生成结构化的提示词，包含：
- 火柴人结构定义
- 坐标系统说明
- 物理规律约束
- 输出格式要求
- 动作设计指导

Author: Your Name
License: MIT
"""


def get_animation_prompt(story: str) -> str:
    """
    Generate the prompt for LLM to create animation
    
    Args:
        story: User's story description
        
    Returns:
        Complete prompt for LLM
    """
    return f"""你是一个专业的火柴人动画生成器。请根据用户的故事描述，生成一系列SVG动画关键帧。

# 火柴人结构定义

每个火柴人由以下部分组成：
- **头部 (head)**: 圆形，属性 {{ "cx": x坐标, "cy": y坐标, "r": 半径(固定20) }}
- **身体 (body)**: 线段，属性 {{ "x1": 起点x, "y1": 起点y, "x2": 终点x, "y2": 终点y }}
- **左臂 (left_arm)**: 线段，从肩膀到手
- **右臂 (right_arm)**: 线段，从肩膀到手
- **左腿 (left_leg)**: 线段，从腰部到脚
- **右腿 (right_leg)**: 线段，从腰部到脚

# 坐标系统

- 画布尺寸：800px 宽 × 600px 高
- 地面位置：y = 520
- 火柴人标准高度：约120px（头20px半径，身体80px，腿60px）
- 坐标原点(0,0)在左上角

# 人体比例参考

站立姿势示例：
```
头部中心: (400, 380)
身体: 从(400, 400)到(400, 480) - 长度80px
左臂: 从(400, 420)到(370, 470) - 肩膀位置在身体上1/4处
右臂: 从(400, 420)到(430, 470)
左腿: 从(400, 480)到(380, 540)
右腿: 从(400, 480)到(420, 540)
```

# 动作设计原则

1. **物理合理性**: 
   - 关节连接要自然（肩膀、腰部、膝盖可弯曲）
   - 重心要平衡（避免不稳定姿势）
   - 动作要连贯（前后帧过渡自然）

2. **时间安排**:
   - 每个关键动作至少包含3-5个关键帧
   - 简单动作: 0.5-1秒 (500-1000ms)
   - 复杂动作: 1-2秒 (1000-2000ms)
   - 位移动作: 根据距离调整（约200px/秒的速度）

3. **动作类型参考**:
   - **行走**: 腿交替前后摆动，手臂相反方向摆动，身体轻微上下起伏
   - **跑步**: 腿摆动幅度更大，身体前倾，手臂摆动幅度增加
   - **跳跃**: 蹲下(腿弯曲) → 腾空(腿伸直，手臂上扬) → 落地(腿再次弯曲)
   - **挥手**: 手臂抬起，手部左右摆动2-3次
   - **弯腰**: 身体线段角度改变，头部位置下降
   - **击掌**: 两个角色靠近，手臂向前伸展，在中间位置接触

# 输出格式要求

请输出标准JSON格式，结构如下：

```json
{{
  "title": "动画标题",
  "description": "动画描述",
  "canvas": {{
    "width": 800,
    "height": 600
  }},
  "characters": [
    {{
      "id": "char_1",
      "name": "角色名称",
      "color": "#2196F3"
    }}
  ],
  "scenes": [
    {{
      "id": "scene_1",
      "duration": 2000,
      "description": "场景描述",
      "frames": [
        {{
          "timestamp": 0,
          "characters": {{
            "char_1": {{
              "head": {{ "cx": 200, "cy": 380, "r": 20 }},
              "body": {{ "x1": 200, "y1": 400, "x2": 200, "y2": 480 }},
              "left_arm": {{ "x1": 200, "y1": 420, "x2": 170, "y2": 470 }},
              "right_arm": {{ "x1": 200, "y1": 420, "x2": 230, "y2": 470 }},
              "left_leg": {{ "x1": 200, "y1": 480, "x2": 180, "y2": 540 }},
              "right_leg": {{ "x1": 200, "y1": 480, "x2": 220, "y2": 540 }}
            }}
          }},
          "text": "旁白文字（可选）"
        }}
      ]
    }}
  ]
}}
```

# 重要提示

1. 确保所有坐标在画布范围内 (0-800, 0-600)
2. 身体各部分必须连接（头底连身体顶，身体底连腿顶等）
3. 每个场景至少包含起始和结束两个关键帧
4. 复杂动作需要更多中间帧来保证流畅性
5. 多角色时注意空间分布，避免重叠
6. 只输出JSON，不要有其他解释文字

# 用户故事

{story}

请根据以上故事生成完整的动画JSON数据。
"""


def get_system_prompt() -> str:
    """Get system prompt for LLM"""
    return """你是一个专业的火柴人动画生成专家。你精通：
1. 人体运动学和物理规律
2. 动画关键帧设计和时间轴规划
3. SVG坐标系统和几何计算
4. 故事叙事和视觉表现

你的任务是将用户的自然语言故事描述，转换为精确的SVG动画关键帧数据。
你必须输出格式规范的JSON数据，确保动画流畅自然、符合物理规律。
"""
